# Plan: 1-2 - Create Verification Report Template and Format

## Objective
Design and create the VERIFICATION_REPORT.md template that structures verification outputs and define STATE.md integration format.

## Context
Now that the reis_verifier specification exists (Wave 1.1), we need to create the template that verifier will use to generate reports. This template must be comprehensive yet scannable, providing clear pass/fail status with supporting evidence.

**Key Requirements:**
- Report must be machine-readable and human-friendly
- Clear executive summary at the top (pass/fail, key issues)
- Detailed sections for tests, quality checks, success criteria, documentation
- Actionable recommendations when verification fails
- Consistent format for STATE.md integration

**Reference Files:**
- `templates/PLAN.md` - Existing template format
- `templates/STATE.md` - State tracking format
- `subagents/reis_verifier.md` - Verification protocol (just created)

## Dependencies
- Wave 1.1 (Subagent Specification) - Must be complete to understand report requirements

## Tasks

<task type="auto">
<name>Create VERIFICATION_REPORT.md template</name>
<files>templates/VERIFICATION_REPORT.md</files>
<action>
Create a comprehensive verification report template that reis_verifier will populate after each verification run.

**Template Structure:**

```markdown
# Verification Report: [Phase/Plan Name]

**Date**: [ISO 8601 timestamp]  
**Phase**: [Phase number and name]  
**Plan**: [Plan file path]  
**Status**: ✅ PASSED | ❌ FAILED | ⚠️ PARTIAL  

## Executive Summary

[2-3 sentence summary of verification results]

**Overall Result**: [Pass/Fail/Partial with explanation]

**Key Findings**:
- [Finding 1]
- [Finding 2]
- [Finding 3]

---

## Test Results

**Test Framework**: [Jest/Vitest/Node/npm test/None]  
**Tests Run**: [Number]  
**Tests Passed**: [Number]  
**Tests Failed**: [Number]  
**Tests Pending**: [Number]  
**Coverage**: [Percentage if available]

### Test Output

```
[Raw or formatted test output]
```

### Failed Tests

[If any tests failed, list them with details]

- ❌ **[Test name]**: [Failure reason]
- ❌ **[Test name]**: [Failure reason]

**Status**: ✅ All tests pass | ❌ [N] tests failing | ⚠️ No tests found

---

## Success Criteria Validation

[For each success criterion from PLAN.md]

### Criterion 1: [Description]
**Status**: ✅ PASS | ❌ FAIL | ⚠️ PARTIAL  
**Evidence**: [What was checked and found]  
**Notes**: [Any relevant context]

### Criterion 2: [Description]
**Status**: ✅ PASS | ❌ FAIL | ⚠️ PARTIAL  
**Evidence**: [What was checked and found]  
**Notes**: [Any relevant context]

**Overall**: ✅ All criteria met | ❌ [N] criteria not met | ⚠️ [N] partially met

---

## Code Quality

### Syntax Check
**Status**: ✅ PASS | ❌ FAIL  
**Details**: [Results of syntax validation]

### Linting
**Tool**: [ESLint/None detected]  
**Status**: ✅ PASS | ❌ FAIL | ⚠️ Not configured  
**Issues Found**: [Number]  
**Details**: [Summary of linting issues]

### Common Issues
- [Issue 1 if found]
- [Issue 2 if found]

**Overall**: ✅ No quality issues | ❌ [N] issues found | ⚠️ Limited checks

---

## Documentation

### Required Documents
- ✅/❌ README.md exists and up-to-date
- ✅/❌ CHANGELOG.md updated
- ✅/❌ API documentation (if applicable)
- ✅/❌ Code comments adequate

### Documentation Issues
[List any documentation gaps or problems]

### TODO/FIXME Comments
**Found**: [Number]  
**Critical**: [Number]  
[List critical TODOs if any]

**Overall**: ✅ Documentation complete | ❌ Missing required docs | ⚠️ Needs improvement

---

## Recommendations

[Only if verification failed or partial]

### Critical Issues (Must Fix)
1. [Issue and how to fix]
2. [Issue and how to fix]

### Warnings (Should Fix)
1. [Issue and how to fix]
2. [Issue and how to fix]

### Suggestions (Nice to Have)
1. [Improvement suggestion]
2. [Improvement suggestion]

---

## Next Steps

[If PASSED]:
- ✅ Phase/Plan verified successfully
- → Proceed to next phase/plan
- → Update STATE.md with verification status

[If FAILED]:
- ❌ Verification failed
- → Review and fix critical issues listed above
- → Re-run verification after fixes
- → Consider running `reis gap-analyze` if stuck

[If PARTIAL]:
- ⚠️ Verification partially passed
- → Review warnings and suggestions
- → Decide whether to proceed or fix issues
- → Document decision in STATE.md

---

## Verification Metadata

**Verifier Version**: [REIS version]  
**Generated By**: reis_verifier  
**Verification Duration**: [Seconds]  
**Report Location**: `.planning/verification/[phase-name]/[timestamp].md`

---

*Generated by REIS Verifier - Autonomous verification for autonomous development*
```

**Key Design Decisions:**
- Use emoji status indicators (✅/❌/⚠️) for quick scanning
- Executive summary first for busy developers
- Detailed sections collapsible in mind (use headers appropriately)
- Clear separation between must-fix and nice-to-have
- Machine-parseable status fields (for future automation)
- Include raw test output for debugging
- Actionable recommendations, not just complaints

**Template Variables** (reis_verifier will replace):
- `[Phase/Plan Name]` - From input
- `[ISO 8601 timestamp]` - Current time
- `[Status]` - Calculated overall status
- `[Test Framework]` - Detected framework
- All bracketed sections - Populated from verification results

</action>
<verify>
```bash
# Check file exists
test -f templates/VERIFICATION_REPORT.md && echo "✅ Template created"

# Verify key sections present
grep -q "## Executive Summary" templates/VERIFICATION_REPORT.md && echo "✅ Executive Summary section"
grep -q "## Test Results" templates/VERIFICATION_REPORT.md && echo "✅ Test Results section"
grep -q "## Success Criteria" templates/VERIFICATION_REPORT.md && echo "✅ Success Criteria section"
grep -q "## Code Quality" templates/VERIFICATION_REPORT.md && echo "✅ Code Quality section"
grep -q "## Documentation" templates/VERIFICATION_REPORT.md && echo "✅ Documentation section"
grep -q "## Recommendations" templates/VERIFICATION_REPORT.md && echo "✅ Recommendations section"

# Check for status indicators
grep -q "✅\|❌\|⚠️" templates/VERIFICATION_REPORT.md && echo "✅ Status indicators present"

# Verify reasonable length (~150 lines)
wc -l templates/VERIFICATION_REPORT.md
```
</verify>
<done>
- templates/VERIFICATION_REPORT.md exists with all required sections
- Contains Executive Summary, Test Results, Success Criteria, Code Quality, Documentation, Recommendations, Next Steps sections
- Uses clear status indicators (✅/❌/⚠️)
- Template variables clearly marked with brackets
- Actionable recommendations structure included
- File is ~150-200 lines with clear formatting
</done>
</task>

<task type="auto">
<name>Document STATE.md verification format</name>
<files>subagents/reis_verifier.md</files>
<action>
Add a section to the reis_verifier specification that defines how verification results integrate with STATE.md.

**Location:** Add a new section after "## Integration Points" (or create if doesn't exist).

**Section to Add:**

```markdown
## STATE.md Integration Format

When verification completes, reis_verifier updates STATE.md with verification status.

### Verification Entry Format

Add entries under "## Recent Progress" section:

```markdown
### [Date] - Verification: Phase [N] - [Phase Name]

**Status**: ✅ PASSED | ❌ FAILED | ⚠️ PARTIAL

**Verified**:
- [Key verification 1]
- [Key verification 2]

**Test Results**: [X/Y tests passing]
**Success Criteria**: [X/Y criteria met]
**Code Quality**: [Status summary]

**Report**: `.planning/verification/[phase-name]/[timestamp].md`

[If failed/partial]:
**Issues Found**:
- [Critical issue 1]
- [Critical issue 2]

**Next Action**: [Recommended next step]
```

### Phase Status Update

When verification passes, update the phase status:

**Before:**
```markdown
**Active Phase**: Phase 2 - Core Implementation
```

**After:**
```markdown
**Active Phase**: Phase 2 - Core Implementation
**Last Verified**: Phase 1 - Design (✅ Passed on [Date])
```

### Blockers Section

If verification fails, optionally add to blockers:

```markdown
## Active Blockers

- [ ] **Phase [N] Verification Failed**: [Summary of critical issues] - See `.planning/verification/[phase-name]/[timestamp].md`
```

### Best Practices

1. **Preserve existing content** - Don't overwrite other state data
2. **Add, don't replace** - Append verification entries to Recent Progress
3. **Clear status** - Use emoji indicators for quick scanning
4. **Link to report** - Always include path to full verification report
5. **Actionable** - Include next steps in verification entry
6. **Timestamp** - Use consistent date format (YYYY-MM-DD)

### Example STATE.md After Verification

```markdown
# Project State

## Current Status

**Active Phase**: Phase 2 - Core Implementation
**Last Verified**: Phase 1 - Design (✅ Passed on 2024-01-18)
**Last Updated**: 2024-01-18
**Overall Progress**: 1/4 phases complete

## Recent Progress

### 2024-01-18 - Verification: Phase 1 - Design & Specification

**Status**: ✅ PASSED

**Verified**:
- Subagent specification complete and follows format
- Template created with all required sections
- Documentation updated

**Test Results**: 10/10 tests passing
**Success Criteria**: 7/7 criteria met
**Code Quality**: No issues found

**Report**: `.planning/verification/phase-1-design/2024-01-18T15-30-00.md`

**Next Action**: Proceed to Phase 2 - Core Implementation

### 2024-01-18 - Completed Phase 1 Tasks

Completed specification and template design for reis_verifier.

**Completed**:
- Created subagents/reis_verifier.md with 7-step protocol
- Created templates/VERIFICATION_REPORT.md
- Updated README.md with verifier reference

...
```
```

**Key Points:**
- Show clear before/after examples
- Explain how to preserve existing STATE.md content
- Document the verification entry format precisely
- Provide best practices for STATE.md updates
- Make it clear this is automated (verifier does this, not human)

**Integration with state-manager.js:**
The verifier should use existing `lib/utils/state-manager.js` utilities for STATE.md manipulation. Note this in the specification.

</action>
<verify>
```bash
# Check that STATE.md integration section was added
grep -q "## STATE.md Integration" subagents/reis_verifier.md && echo "✅ STATE.md section added"

# Verify format examples included
grep -q "Verification Entry Format" subagents/reis_verifier.md && echo "✅ Entry format documented"

# Check for before/after examples
grep -q "Before:" subagents/reis_verifier.md && grep -q "After:" subagents/reis_verifier.md && echo "✅ Examples included"

# Verify best practices listed
grep -q "Best Practices" subagents/reis_verifier.md && echo "✅ Best practices documented"
```
</verify>
<done>
- subagents/reis_verifier.md updated with STATE.md integration section
- Verification entry format clearly defined
- Phase status update format documented
- Before/after examples included
- Best practices for STATE.md updates listed
- References state-manager.js for implementation
</done>
</task>

<task type="auto">
<name>Create example verification report</name>
<files>.planning/verifier-project/examples/example-verification-report.md</files>
<action>
Create a realistic example verification report to demonstrate the template in action. This serves as both documentation and a test fixture.

**Create directory first:**
```bash
mkdir -p .planning/verifier-project/examples
```

**Example Report Content:**
Create a complete example showing a **PARTIAL** verification (more interesting than pure pass/fail). This shows all sections populated with realistic data.

**Scenario**: Phase 2 verification where tests pass but one success criterion is not fully met.

Use this structure:
- Phase: Phase 2 - Core Implementation
- Status: ⚠️ PARTIAL
- Tests: 23/23 passing
- Success Criteria: 3/4 met (one partially met)
- Code Quality: ESLint found 2 warnings
- Documentation: README needs update

Fill in ALL template sections with realistic content (test output, linting results, recommendations). Make it feel like a real verification run.

**Purpose:**
- Demonstrates template usage
- Serves as reference for developers
- Can be used in tests later
- Shows what partial success looks like

Make it detailed enough to be useful but concise enough to scan quickly.

</action>
<verify>
```bash
# Check file exists
test -f .planning/verifier-project/examples/example-verification-report.md && echo "✅ Example report created"

# Verify it follows template structure
grep -q "# Verification Report:" .planning/verifier-project/examples/example-verification-report.md && echo "✅ Has title"
grep -q "## Executive Summary" .planning/verifier-project/examples/example-verification-report.md && echo "✅ Has executive summary"
grep -q "## Test Results" .planning/verifier-project/examples/example-verification-report.md && echo "✅ Has test results"
grep -q "## Recommendations" .planning/verifier-project/examples/example-verification-report.md && echo "✅ Has recommendations"

# Verify status is PARTIAL
grep -q "⚠️ PARTIAL" .planning/verifier-project/examples/example-verification-report.md && echo "✅ Shows PARTIAL status"

# Check reasonable length
wc -l .planning/verifier-project/examples/example-verification-report.md
```
</verify>
<done>
- Example report created at .planning/verifier-project/examples/example-verification-report.md
- Follows VERIFICATION_REPORT.md template exactly
- All sections populated with realistic data
- Shows PARTIAL verification scenario
- Includes test output, linting results, recommendations
- Demonstrates actionable recommendations format
- Can serve as documentation and test fixture
</done>
</task>

## Success Criteria
- ✅ templates/VERIFICATION_REPORT.md created with comprehensive structure
- ✅ All required sections included (Summary, Tests, Criteria, Quality, Docs, Recommendations)
- ✅ Clear status indicators (✅/❌/⚠️) used throughout
- ✅ Template variables marked for reis_verifier to populate
- ✅ STATE.md integration format documented in subagents/reis_verifier.md
- ✅ Before/after examples of STATE.md updates included
- ✅ Example verification report created demonstrating template usage
- ✅ Template is ~150-200 lines, scannable and actionable

## Verification

```bash
# Verify all files created
ls -lh templates/VERIFICATION_REPORT.md
ls -lh .planning/verifier-project/examples/example-verification-report.md

# Check template structure
cat templates/VERIFICATION_REPORT.md | grep "^## " | head -10

# Verify STATE.md integration documented
grep -A20 "STATE.md Integration" subagents/reis_verifier.md

# Check example report quality
head -50 .planning/verifier-project/examples/example-verification-report.md

# Line counts
echo "Template lines:"
wc -l templates/VERIFICATION_REPORT.md
echo "Example report lines:"
wc -l .planning/verifier-project/examples/example-verification-report.md
```

---

*This plan will be executed by reis_executor in a fresh context.*
